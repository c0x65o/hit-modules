Metadata-Version: 2.4
Name: hit-modules
Version: 0.1.0
Summary: Shared middleware utilities for HIT microservices
Author-email: HIT Platform <platform@hitlabs.dev>
Requires-Python: >=3.11
Description-Content-Type: text/markdown
Requires-Dist: requests>=2.31.0
Requires-Dist: pydantic>=2.0.0
Requires-Dist: python-jose>=3.3.0
Requires-Dist: fastapi>=0.110.0
Requires-Dist: uvicorn>=0.23.0
Provides-Extra: sqlalchemy
Requires-Dist: SQLAlchemy>=2.0.0; extra == "sqlalchemy"
Provides-Extra: dev
Requires-Dist: pytest>=7.4.0; extra == "dev"
Requires-Dist: httpx>=0.26.0; extra == "dev"

# hit-modules

Shared plumbing for HIT microservices. This repo now contains:

- **Python middleware client** (`python/hit_modules`) for modules to fetch secrets/tokens via the provisioner.
- **Provisioner service** (FastAPI) that exposes `/healthz` and `/api/v1/secrets/database`.
- Reference tests that exercise the happy path.

## Running the provisioner locally

```
export PROVISIONER_ALLOW_ANONYMOUS=1
export HIT_PROVISIONER_DEFAULT_DB_URL="postgresql://local@localhost/dev"
uv run python -m hit_modules.provisioner
```

Then POST to `http://127.0.0.1:8700/api/v1/secrets/database` with:

```json
{
  "namespace": "shared",
  "secretKey": "auth-db"
}
```

The server will return a connection string (either from a JSON secrets file referenced by `PROVISIONER_SECRETS_PATH` or from `HIT_PROVISIONER_DEFAULT_DB_URL`).

## Tests

```
uv run --extra dev pytest
```

